<!DOCTYPE html>
<html>
<head>
  <title>User Dashboard</title>
</head>
<body>
  <h2>Submit Review</h2>
<h1 style="color:red">USER DASHBOARD LOADED</h1>

  <label>Rating:</label>
  <select id="rating">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
  </select>
  <br /><br />

  <textarea
    id="review"
    rows="4"
    cols="50"
    placeholder="Write your review here..."
  ></textarea>
  <br /><br />

  <button onclick="submitReview()">Submit</button>

  <h3>AI Response</h3>
  <div
    id="aiResponseBox"
    style="border:1px solid #ccc; padding:10px; min-height:50px;"
  >
    Waiting for AI response...
  </div>

  <script>
    alert("User dashboard JS loaded");

    async function submitReview() {
      const rating = document.getElementById("rating").value;
      const review = document.getElementById("review").value;

      const res = await fetch(
        "https://fynd-backend-tl8g.onrender.com/api/reviews",
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ rating, review })
        }
      );

      const data = await res.json();

      console.log("API response:", data); // ðŸ‘ˆ IMPORTANT

      if (!res.ok) {
        document.getElementById("aiResponseBox").innerText =
          "Submission failed.";
        return;
      }

      document.getElementById("aiResponseBox").innerHTML = `
        <p><strong>AI Reply:</strong> ${data.aiResponse}</p>
        <p><strong>Summary:</strong> ${data.summary}</p>
        <p><strong>Suggested Action:</strong> ${data.action}</p>
      `;
    }
  </script>
</body>
</html>
